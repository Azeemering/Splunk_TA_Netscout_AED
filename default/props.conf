# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/Splunk_TA_netscout_AED/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/Splunk_TA_netscout_AED/default
# into ../local and edit there.

[netscout:aed]
description = NETSCOUT Arbor Edge Defense (AED) syslog output field extractions
category = Network & Security

#EVALS
EVAL-app = "Netscout Arbor Edge Defense"
EVAL-vendor_product = "Netscout Arbor Edge Defense"
EVAL-ids_type = "network"

# eval field rt from epoch timestamp. This is the actual AED eventtime.
EVAL-rt = strftime(epoch,"%F %T")

EXTRACT-Extract src_port = (?i) source port (?P<src_port>\d+)
EXTRACT-category = arbor-networks-aps:(?P<category>\w+)

# Destination IP address (IPv4)
EXTRACT-dest = \sdestination\s(?<dest>[0-9]{1,3}[.][0-9]{1,3}[.][0-9]{1,3}[.][0-9]{1,3}),

# Source IP address (IPv4 | IPv6)
EXTRACT-src_ip = (?i) host (?P<src_ip>[^ ]+)

EXTRACT-action = :Blocked\sHost:\s(?P<action>\w+)
EXTRACT-dest_port = (?i) .*?/(?P<dest_port>\d+)(?= )
EXTRACT-url = (?i),URL: (?P<url>.+)
EXTRACT-arbor_signature = (?i) by (?P<arbor_signature>.+?)\s+\w+\s+\d+

# timestamp of AED event in EPOCH format;
EXTRACT-epoch = EPOCH:\s(?P<rt>\d{10})
EXTRACT-dvc = ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d+\+.....\s(?P<dvc>\S+)\s

# AED Protection Group ID
EXTRACT-pgid = PGID:\s(?P<protection_group_id>\d+),

# AED Protection Group Name; end of line in msg
EXTRACT-pgname = PGNAME:\s(?<protection_group_name>.+),

EXTRACT-username = Username:\s(?P<username>\w+),
EXTRACT-subsystem = Subsystem:\s(?P<subsystyem>[^,]+)
EXTRACT-message = Message:\s(?P<message>[^:]+)
EXTRACT-traffic_level = traffic\slevel\swas\s(?P<traffic_level>\d+\.\d+\s+)
